---
layout: post
title: "Boa release v0.11"
author: Boa Developers
---

Boa has reached a new release. v0.11, our biggest one yet. Since v0.10 we've closed 77 issues, merged 129 pull requests. The engine has been faster and more compliant to the spec. Below are some of the highlights but please see the [changelog link] for more information.

## Test 262

Test262 is the implementation conformance test suite maintained by TC39. It's used by nearly all engines to measure how conformant they are to the specification. Boa pulls the tests in-tree and runs against PRs and on a nightly basis. Test262 doesn't sit still, so since the last release we've updated our reference to make sure we're running against the latest spec. You can find more about Test262 [here](https://github.com/tc39/test262).

Since v0.10 we have almost doubled on spec conformance, and reduced panics from hundreds to less than 50. A year ago Boa didn't even track itself against Test262 so it was difficult to know how compliant we were to the spec, today not only do we track all changes against Test262 but we can see progress on a PR to PR basis.

For live tracking of conformance tests you can check [here](https://boa-dev.github.io/boa/test262/). Below is a snapshot of the previous version and today.

<div class="row" style="display: flex; justify-content: space-around;">
        <section class="col-md-4" style="" id="version-latest"><div class="card"><div class="card-body"><h3>v0.10:</h3><ul class="list-group list-group-flush"><li class="list-group-item">Total tests: <span class="total-tests">38,706</span></li><li class="list-group-item">Passed tests: <span class="passed-tests">6,960</span></li><li class="list-group-item">Ignored tests: <span class="ignored-tests">5,748</span></li><li class="list-group-item">Failed tests: <span class="failed-tests">25,998</span></li><li class="list-group-item">Conformance: <b>17.98%</b></li></ul><div class="info-link"><a class="card-link" href="#"><span class="info-link"></span></a></div></div></div></section>
        <section class="col-md-4" style="" id="master-latest"><div class="card"><div class="card-body"><h3>v0.11:</h3><ul class="list-group list-group-flush"><li class="list-group-item">Total tests: <span class="total-tests">78,497</span></li><li class="list-group-item">Passed tests: <span class="passed-tests">24,550</span></li><li class="list-group-item">Ignored tests: <span class="ignored-tests">15,585</span></li><li class="list-group-item">Failed tests: <span class="failed-tests">38,362 (24 âš )</span></li><li class="list-group-item">Conformance: <b>31.28%</b></li></ul><div class="info-link"><a class="card-link" href="#"><span class="info-link"></span></a></div></div></div></section>
        <section class="col-md-4" style="display: none" id="old-versions"></section>
</div>

## Regress

In this release Boa switched from its own implementation (wrapping `regex`) to the [`regress`](https://github.com/ridiculousfish/regress) engine for regular expressions. Regress is a crate aiming to implement ECMAScript compliant regular expressions and Boa makes use (and contributes back to) that.

While Regress is not 100% spec compliant this is something which is being worked on, also the switch gave us quite a performance boost in our [benchmarks](https://boa-dev.github.io/boa/dev/bench/) we're seeing almost 6X faster execution.

<picture>
    <source srcset="/images/2021-09-11/regex-bench-dark.png" media="(prefers-color-scheme: dark)">
    <img src="/images/2021-09-11/regex-bench-white.png">
</picture>

The above image shows a big drop in the middle of the graph, above `fb1b8d5` is where we switched over. Conformance went from 19.01% to 18.99% and introduced some panics, however many of those have since been fixed.

## Iterating over bytes

Previously the lexer iterated over Unicode chars (u32 code points), this wasn't strictly neccesary for Boa and we have instead changed the lexer to work over bytes (u8). Iterating over bytes rather than chars is inherently much faster, non-ascii UTF8 bytes are all >=128, and we might only really care about those being correct when parsing idents. This is standard practise amongs lexical analyzers and even browsers read source code byte-by-byte, using the rules of the language's syntax to convert the source text into tokens.

This was worked on by @jevancc and his [changes](https://github.com/boa-dev/boa/pull/915/files) have improved performance overall.

## Embedding examples

We are still working on what the public API should look like, some of these decisions are driven by feedback and the constant changing way which Boa works.  
Not only you can run Boa against javascript today you can also embed your own objects and classes into the engine before it's ran.

We've offered an [example](https://github.com/boa-dev/boa/blob/master/boa/examples/classes.rs) to show how a class can be constructed in Rust then added to the environment before executing your scripts.
This should offer a great insight into how you can interop Rust with JavaScript by using Boa.

If there are any examples you would like added, please raise an issue on the main repository.

## Generating bytecode

Today Boa walks the tree of the AST, although easy to implement it's not ideal for performance.  
We are loooking to do code generation which can then be interpreted. This gradual process may happen over many releases until at some point we can switch implementations under the hood. Our steps are:

- ~~Experiment with VM Path on isolated branch~~
- ~~Experiment with generating more simpler instructions~~
- Build up parity with current implementation
- Run test suite over VM path including conformance tests
- Switch over once performance is steady
- Optimize code generation and intreperter

## Thank You

Everything in this release has been such a huge effort, we thank everyone who contributed, whether it was features, fixes or raising bugs.
